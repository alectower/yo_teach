<section id='calendar'>
  <table>
    <caption>
      <div id='prev-month'>
        <%= link_to raw("<i class='icon-chevron-left'></i>"), calendar_path(date: @calendar.prev_month) %>
      </div>
      <h2><%= @calendar.month %>  <%= @calendar.year %></h2>
      <div id='next-month'>
        <%= link_to raw("<i class='icon-chevron-right'></i>"), calendar_path(date: @calendar.next_month) %>
      </div>
      <div id='calendar-views'>
          <%= link_to 'This Month', calendar_path, class: 'active' %>
          <%= link_to 'This Week', calendar_path(view: :week) %>
      </div>
    </caption>
    <thead>
      <tr>
        <th>Sunday</th>
        <th>Monday</th>
        <th>Tuesday</th>
        <th>Wednesday</th>
        <th>Thursday</th>
        <th>Friday</th>
        <th>Saturday</th>
      </tr>
    </thead>
    <% @calendar.each_week do |week| %>
      <tr class="<%= week_class %>">
        <% week.each do |day| %>
          <td class="day">
            <div class=<%= day.date.today? ? 'today' : 'date' %>>
              <span><%= day.date.mday %></span>
            </div>
            <ul class='unstyled courses'>
              <% day.lessons.each do |lesson| %>
                <% if lesson.course.end_date > day.date %>
                  <li class='course'>
                    <%= link_to lesson.course.name,
                      edit_lesson_plan_path(lesson), class: "status-underline#{lesson.status}" %>
                    <span class='time'><%= lesson.start_time %></span>
                  </li>
                <% end %>
              <% end %>
            </ul>
            <div class="add-lesson-plan">
              <% start = 9.hours.since(day.date.to_datetime) %>
              <%= link_to raw("<i class='icon-plus'></i>"),
                new_lesson_plan_path(start: start,
                                     end: 1.hour.since(start)) %>
            </div>
          </td>
        <% end %>
      </tr>
    <% end %>
  </table>
</section>

